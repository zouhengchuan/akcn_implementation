zetas = [343, 2199, 915, 2542, 3114, 1258, 1242, 1361, 854, 2603, 2215, 2096, 2001, 3153, 1760, 1697, 1456, 304, 2559, 1560, 2795, 662, 898, 1897, 664, 2342, 451, 3006, 2793, 1115, 2233, 1264, 3417, 40, 1224, 2193, 1485, 500, 1472, 1985, 1972, 2957, 1386, 1619, 452, 3005, 2071, 1838, 2072, 2560, 2282, 1175, 1385, 897, 1012, 1237, 1208, 2249, 2445, 2220, 94, 2185, 1178, 2279, 3363, 1272, 1701, 887, 869, 2588, 1756, 2570, 413, 884, 2160, 1297, 3044, 2573, 155, 1286, 2016, 1441, 3302, 2171, 1210, 2456, 3248, 209, 2247, 1001, 3434, 679, 2801, 656, 23, 2778, 3275, 3419, 220, 3237, 182, 38, 752, 195, 2510, 947, 2705, 3262, 2748, 3195, 971, 2486, 709, 262, 1182, 2982, 2750, 707, 2275, 475, 1482, 1791, 184, 3273, 1975, 1666, 2766, 2363, 1785, 1672, 691, 1094, 3304, 158, 3452, 5, 153, 3299, 1240, 3374, 2300, 1157, 2217, 83, 876, 3298, 2740, 717, 2581, 159, 1509, 543, 1405, 2052, 1948, 2914, 1855, 1451, 151, 3306, 1602, 2006, 579, 3198, 3137, 320, 2878, 259, 2744, 307, 406, 3051, 713, 3150, 3022, 517, 3375, 82, 435, 2940, 2180, 1025, 252, 3205, 1277, 2432, 3187, 2109, 1618, 1839, 270, 1348, 1649, 1370, 438, 3019, 1808, 2087, 2000, 2431, 2483, 974, 1457, 1026, 2454, 1804, 2656, 801, 1003, 1653, 1599, 3297, 2018, 1439, 1858, 160, 1882, 203, 1372, 2085, 1575, 3254, 1987, 3416, 1511, 1946, 1470, 41, 2241, 126, 1090, 2367, 1216, 3331, 2783, 809, 3322, 135, 674, 2648, 2624, 92, 741, 2716, 833, 3365, 2910, 2621, 1383, 2074, 547, 836, 79, 1726, 1652, 1805, 3378, 1731, 1687, 1150, 620, 2837, 1770, 2307, 3326, 2214, 1374, 2083, 131, 1243, 1491, 1375, 591, 2866, 1966, 2082, 1826, 1255, 376, 3081, 1631, 2202, 91, 19, 3347, 110, 3366, 3438, 1171, 1954, 332, 3125, 2286, 1503, 632, 3437, 2845, 612, 2825, 20, 250, 736, 2471, 986, 3207, 2721, 2538, 226, 693, 2764, 919, 3231, 3305, 880, 2729, 728, 152, 2577, 780, 3126, 3008, 449, 2677, 331, 2409, 427, 621, 2836, 1048, 3030, 1557, 629, 1271, 2186, 1900, 2828, 442, 1080, 1935, 1522, 3015, 2377, 643, 1008, 1806, 1651, 2814, 2449, 1228, 1624, 605, 2852, 2229, 1833, 2068, 3129, 1717, 1740, 1389, 328, 2821, 589, 47, 3410, 636, 2868, 2172, 2163, 2579, 878, 1285, 1294, 2347, 604, 506, 2951, 1110, 2853, 2421, 2177, 2316, 1141, 1036, 1280]

def evaluate_polynomial(coefficients, x, mod=3457):
    result = 0
    for i, coeff in enumerate(coefficients):
        result += coeff * (x ** i)
        result = result % mod   # 进行取模运算
    return result

def ntt_poly(zetas,coefficients, mod=3457):
    even_coeffs = coeffs[::2]  # 偶数次幂的系数
    odd_coeffs = coeffs[1::2]  # 奇数次幂的系数
    ans = []
    for x_value in zetas:
        ans.append(evaluate_polynomial(even_coeffs, x_value))
        ans.append(evaluate_polynomial(odd_coeffs, x_value))
    return ans

def poly_mul(zetas,a,b):
    c = []
    for i,zeta in enumerate(zetas):
        c.append((a[2*i] * b[2*i] + a[2*i+1] * b[2*i+1] * zeta) % 3457)
        c.append((a[2*i] * b[2*i+1] + a[2*i+1] * b[2*i]) % 3457)
    return c

def schoolbook(a,b):
    c = [0] * 768
    for i in range(768):
        for j in range(768):
            if (i + j < 768):
                c[i+j] += a[i] * b[j]
            elif (i + j < 1152):
                c[i+j-768] -= a[i] * b[j]
                c[i+j-384] += a[i] * b[j]
            else:
                c[i+j-1152] -= a[i] * b[j]
    for i in range(768):
        c[i] = c[i] % 3457
    return c
# 示例多项式的系数
coeffs = [2553,1706,1529,1978,40,1274,2140,22,783,641,581,2800,1472,2052,1901,842,1275,372,3406,3172,3030,471,155,2779,512,3396,843,90,207,3052,2426,3232,2048,2634,1224,1261,3215,216,2013,2181,2783,1390,928,2159,1997,643,119,1408,3387,947,2867,2898,1527,1459,3105,2774,1382,2265,1798,2405,1178,867,1832,1932,3101,1674,1294,2781,2954,1227,2234,571,937,3397,2840,2595,550,1666,1279,2161,2427,2984,876,1856,1709,3269,164,1044,1291,843,2565,2280,3085,2400,746,439,1886,2771,1304,3108,1127,1757,2599,2529,1887,3050,2664,1924,999,1441,1420,266,1517,725,37,2710,1991,466,425,1565,1934,1563,2303,1861,2308,100,3081,2275,635,2056,146,456,2029,2808,713,2407,3184,1604,2271,1970,2826,403,2214,130,292,3343,3163,1843,1138,3137,3112,612,2929,2031,1093,2957,1686,605,1093,2580,1129,2759,1734,2951,1935,979,1636,1976,2754,1049,1370,2752,3063,825,1408,1294,2967,1173,2360,387,45,816,549,2361,2844,1578,624,3345,1876,2161,136,2119,32,2494,1654,921,2387,1499,158,744,1220,759,861,3121,1959,2399,1276,400,46,2540,858,3454,2953,255,1083,2793,678,3204,1593,194,2464,2600,1600,3000,3421,1843,1718,3055,695,3211,1094,2751,3431,2290,1127,879,877,2484,2330,3187,1351,1833,2462,1555,1109,3344,3031,515,1906,979,1887,1822,2338,3124,1065,1610,1416,2355,1423,2089,1406,982,2284,247,2531,2229,2907,3310,463,2362,1477,2166,541,3138,2599,3230,502,2950,157,990,132,1347,1471,2295,2554,938,2973,2436,1179,2735,24,2851,1882,1302,1933,741,2881,1771,1193,2824,2153,1584,317,3214,1253,1320,3356,426,1324,2989,1336,2056,3446,1715,1010,2085,541,3141,3079,3381,1253,2308,2165,385,3002,2117,1253,1533,713,387,1468,2933,358,140,3164,1251,373,713,3094,1906,1214,737,2001,2403,3152,589,180,3011,1278,3338,3035,1727,2229,2879,2324,1596,2868,3328,2769,563,2414,1330,319,2496,1387,3449,42,1742,492,3395,469,1324,783,2432,824,526,466,347,2803,1532,798,846,2821,2236,2577,1964,1610,1787,3410,3388,1039,3177,1521,712,1444,1204,3277,7,1483,1044,3122,440,1285,3106,325,3425,2216,3028,1503,1842,619,1611,3124,2487,688,2972,3153,225,2810,1312,1213,3282,3440,482,3290,2069,1022,3423,2407,1898,1838,2439,3358,1113,847,3303,1736,1503,407,1589,100,229,502,1943,2755,1613,617,389,1711,2632,23,1545,2899,2259,2534,1293,1160,778,2339,1947,447,850,292,1515,2332,215,1587,3256,1197,1157,2146,2157,24,756,2684,1919,1992,2641,2113,2952,2015,629,119,2496,1001,2028,50,136,983,810,781,1697,360,2127,434,3018,86,1675,258,2543,2112,669,2960,1317,243,2977,1333,940,1237,1128,2655,2461,2315,1819,1467,2,2765,1588,3295,1101,1840,1400,2634,480,1416,1735,101,3,85,3102,3194,1018,1483,856,2400,1431,2466,816,2764,1996,974,2324,147,3391,2274,2844,3431,1167,1384,2221,2210,490,1192,1548,9,1210,1460,943,3124,846,1506,1101,2790,2276,1067,1254,3323,2246,848,762,2331,2403,3170,2028,3044,692,2317,2686,3183,1281,1455,2771,3045,686,124,841,1280,3428,1473,315,1642,2026,2939,2738,235,2272,3176,1865,1657,2486,2798,1626,1444,173,418,2187,2163,3327,2624,3251,2690,2002,2775,351,176,2722,1335,2161,2554,2848,367,1534,1572,546,1769,1758,1450,1751,2598,623,1768,2681,3137,3253,2098,609,1417,3294,78,448,581,887,3338,3121,85,605,147,2262,1052,403,297,2828,3364,1411,340,2127,2689,181,475,2853,2429,2777,328,271,3242,1334,1020,2305,1266,1863,2017,2253,2643,201,1184,280,3067,2904,162,234,456,2974,604,720,1745,3148,3428,2987,63,134,2216,1423,2504,921,1725,1318,1171,469,1854,2936,725,335,2234,2356,710,381,996,320,1558,1957,199,1866,35,1088,761,1743,976,2002,740,1280,300,1801,2304,719,109,817,2281,1482,1479,1268,992,725,2932,2880,1323,1769,2124,2634,1055,2221,2671,2004,128,1216,2734,179,1293,3403,2589,1559,2264,98,1176,897,3196,212,76,3074,3208,3179,1220,2808,1081,2931,2668,2179,2613,452]  

c_0 = schoolbook(coeffs,coeffs)
b = ntt_poly(zetas, coeffs)
a = ntt_poly(zetas, coeffs)
c = poly_mul(zetas,a,b)

print(c_0)
print(c)